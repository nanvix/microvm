# Copyright(c) The Maintainers of Nanvix.
# Licensed under the MIT License.

/*================================================================================================*
 * Exported Symbols                                                                               *
 *================================================================================================*/

.global _start

/*================================================================================================*
 * Imported Symbols                                                                               *
 *================================================================================================*/

.extern kmain

/*================================================================================================*
 * Text Section                                                                                   *
 *================================================================================================*/

.section .text

/*------------------------------------------------------------------------------------------------*
 * _start()                                                                                       *
 *------------------------------------------------------------------------------------------------*/

.code32
.align 4
_start:
    /* Set up the stack pointer. */
    movl $kstack, %esp
    movl $kstack, %ebp

    /* Call kmain. */
    call kmain

    /* Shutdown. */
    htlt:
        hlt
        jmp htlt

/*================================================================================================*
 * BSS Section                                                                                    *
 *================================================================================================*/

.section .bss

.align 4096
.space 4096
kstack:
